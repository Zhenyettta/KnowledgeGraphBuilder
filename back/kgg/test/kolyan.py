import uuid

from gliner import GLiNER
from langchain_text_splitters import RecursiveCharacterTextSplitter, CharacterTextSplitter
from sympy import false
from transformers import AutoTokenizer, BartTokenizer

from kgg.models import Entity
from kgg.prompts import GLINER_LLM_PROMPT

model = GLiNER.from_pretrained('urchade/gliner_large-v2.1')
text = "The pan-European 112 code was introduced in the UK in April 1995 with little publicity. It connects to existing 999 circuits. The GSM standard mandates that the user of a GSM phone can dial 112 without unlocking the keypad, a feature that can save time in emergencies but that also causes some accidental calls. All mobile telephones will make emergency calls with the keypad locked. Originally a valid SIM card was not required to make a 999 / 112 emergency call in the UK. However, as a result of high numbers of untraceable hoax calls being made, this feature is now blocked by all UK networks. Most UK mobile telephone handsets will dial 999 / 112 without a SIM inserted (or with a locked / invalid SIM), but the call will not be connected. Following the blocking of SIM-less calls, in 2009 the UK networks introduced emergency call roaming. This allows a user with a valid SIM of a UK network to make emergency calls on any network for which they have coverage. Energy: This principle is vitally important to understanding the behaviour of a quantity closely related to energy, called entropy. Entropy is a measure of evenness of a distribution of energy between parts of a system. When an isolated system is given more degrees of freedom (i.e., given new available energy states that are the same as existing states), then total energy spreads over all available degrees equally without distinction between \"new\" and \"old\" degrees. This mathematical result is called the second law of thermodynamics. Wernicke's area: Wernicke's area is named after Carl Wernicke, a German neurologist and psychiatrist who, in 1874, hypothesized a link between the left posterior section of the superior temporal gyrus and the reflexive mimicking of words and their syllables that associated the sensory and motor images of spoken words. He did this on the basis of the location of brain injuries that caused aphasia. Receptive aphasia in which such abilities are preserved is also known as Wernicke's aphasia. In this condition there is a major impairment of language comprehension, while speech retains a natural-sounding rhythm and a relatively normal syntax. Language as a result is largely meaningless (a condition sometimes called \"fluent\" or \"jargon aphasia\"). State legislature (United States): Nebraska originally had a bicameral legislature like the other states, but the lower house was abolished following a referendum, effective with the 1936 elections. The remaining unicameral (one - chamber) legislature is called the Nebraska Legislature, but its members continue to be called senators. End Conscription Campaign: On 24 August 1993 Minister of Defence Kobie Coetsee announced the end of conscription. In 1994 there would be no more call - ups for the one - year initial training. But although conscription was suspended it was not entirely abandoned. Indeed, in January 1994 for the first time there was no call - up for initial training, but at the same time conscripts who had already undergone training could be subject to ``camp ''call - ups, as they were technically subject to military law rather than civilian law. Actually`` camp'' call - ups reached record proportions over the period of the April 1994 elections, and for the first time in history the ECC called on conscripts to consider these call - ups to be different from previous call - ups. Buddhism: In Buddhism, Karma (from Sanskrit: \"action, work\") is the force that drives saṃsāra—the cycle of suffering and rebirth for each being. Good, skillful deeds (Pali: \"kusala\") and bad, unskillful (Pāli: \"akusala\") actions produce \"seeds\" in the mind that come to fruition either in this life or in a subsequent rebirth. The avoidance of unwholesome actions and the cultivation of positive actions is called sīla. Karma specifically refers to those actions of body, speech or mind that spring from mental intent (cetanā), and bring about a consequence or phala \"fruit\" or vipāka \"result\". Canon law: Much of the legislative style was adapted from the Roman Law Code of Justinian. As a result, Roman ecclesiastical courts tend to follow the Roman Law style of continental Europe with some variation, featuring collegiate panels of judges and an investigative form of proceeding, called \"inquisitorial\", from the Latin \"inquirere\", to enquire. This is in contrast to the adversarial form of proceeding found in the common law system of English and U.S. law, which features such things as juries and single judges. False Claims Act: The False Claims Act, also called the ``Lincoln Law '') is an American federal law that imposes liability on persons and companies (typically federal contractors) who defraud governmental programs. It is the federal Government's primary litigation tool in combating fraud against the Government. The law includes a qui tam provision that allows people who are not affiliated with the government, called`` relators'' under the law, to file actions on behalf of the government (informally called ``whistleblowing ''especially when the relator is employed by the organization accused in the suit). Persons filing under the Act stand to receive a portion (usually about 15 -- 25 percent) of any recovered damages. As of 2012, over 70 percent of all federal Government FCA actions were initiated by whistleblowers. Claims under the law have typically involved health care, military, or other government spending programs, and dominate the list of largest pharmaceutical settlements. The government recovered $38.9 billion under the False Claims Act between 1987 and 2013 and of this amount, $27.2 billion or 70% was from qui tam cases brought by relators. Geological history of Earth: The Ordovician Period started at a major extinction event called the Cambrian-Ordovician extinction events some time about 485.4 ± 1.9 Ma. During the Ordovician the southern continents were collected into a single continent called Gondwana. Gondwana started the period in the equatorial latitudes and, as the period progressed, drifted toward the South Pole. Early in the Ordovician the continents Laurentia, Siberia and Baltica were still independent continents (since the break-up of the supercontinent Pannotia earlier), but Baltica began to move toward Laurentia later in the period, causing the Iapetus Ocean to shrink between them. Also, Avalonia broke free from Gondwana and began to head north toward Laurentia. The Rheic Ocean was formed as a result of this. By the end of the period, Gondwana had neared or approached the pole and was largely glaciated. La Tour-Blanche Anticline: The La Tour-Blanche Anticline, also called Chapdeuil Anticline or Chapdeuil-La Tour-Blanche Anticline, is a tectonically caused, dome-like upwarp in the sedimentary succession of the northeastern Aquitaine Basin in France. The structure is oriented west-northwest-east-southeast. Vacuum: QED vacuum has interesting and complex properties. In QED vacuum, the electric and magnetic fields have zero average values, but their variances are not zero. As a result, QED vacuum contains vacuum fluctuations (virtual particles that hop into and out of existence), and a finite energy called vacuum energy. Vacuum fluctuations are an essential and ubiquitous part of quantum field theory. Some experimentally verified effects of vacuum fluctuations include spontaneous emission and the Lamb shift. Coulomb's law and the electric potential in vacuum near an electric charge are modified. National Do Not Call Registry: On June 27, 2003, the U.S. Federal Trade Commission (FTC) opened the National Do Not Call Registry in order to comply with the Do - Not - Call Implementation Act of 2003 (Pub. L. 108 -- 10, was H.R. 395, and codified at 15 U.S.C. § 6101 et. seq.), sponsored by Representatives Billy Tauzin and John Dingell and signed into law by President George W. Bush on March 11, 2003. The law established the FTC's National Do Not Call Registry in order to facilitate compliance with the Telephone Consumer Protection Act of 1991. Chromosome 21: In a small percentage of cases, Down syndrome is caused by a rearrangement of chromosomal material between chromosome 21 and another chromosome. As a result, a person has the usual two copies of chromosome 21, plus extra material from chromosome 21 attached to another chromosome. These cases are called translocation Down syndrome. Researchers believe that extra copies of genes on chromosome 21 disrupt the course of normal development, causing the characteristic features of Down syndrome and the increased risk of medical problems associated with this disorder. James Gillett: The denying of Pardee's renomination caused immediate controversy and outrage. Pardee, due to his efficient bureaucracy and direction of the state government's response to the 1906 San Francisco earthquake, remained an enormously popular politician. His replacement by Gillett, a Railroad Republican, caused anger both in the press and within political circles. The San Francisco Call printed a photograph taken at the convention's end of Gillett among top party bosses entitled ``the Shame of California. ''Gillett's nomination by special interests would fuel calls for a direct primary law in the state. Immune system: Another important role of the immune system is to identify and eliminate tumors. This is called immune surveillance. The transformed cells of tumors express antigens that are not found on normal cells. To the immune system, these antigens appear foreign, and their presence causes immune cells to attack the transformed tumor cells. The antigens expressed by tumors have several sources; some are derived from oncogenic viruses like human papillomavirus, which causes cervical cancer, while others are the organism's own proteins that occur at low levels in normal cells but reach high levels in tumor cells. One example is an enzyme called tyrosinase that, when expressed at high levels, transforms certain skin cells (e.g. melanocytes) into tumors called melanomas. A third possible source of tumor antigens are proteins normally important for regulating cell growth and survival, that commonly mutate into cancer inducing molecules called oncogenes. Julien Chouinard: Born in Quebec City, the son of Joseph Julien Chouinard and Berthe Cloutier, he received a BA in 1948 and a LL.L. in 1951 from Université Laval. As a Rhodes Scholar, he received a BA in 1953 from Oxford University. In 1953, he was called to the Quebec Bar and started to practice law. He also taught law at Université Laval. Zack Kopplin: Zachary \"Zack\" Sawyer Kopplin (born July 20, 1993) is an American political activist, journalist, and television personality from Louisiana. Kopplin has campaigned to keep creationism out of public school science classrooms and been involved with other separation of church and state causes. He has opposed school vouchers because they provide public money to schools which may teach creationism. As a high school student, he organized seventy-eight Nobel laureate scientists in a campaign against the Louisiana Science Education Act, a creationism law. He is also involved with science funding policy and curriculum and textbook policy. His new campaign calls for a launching Second Giant Leap for Humankind, calling for Barack Obama to invest $1 trillion in research and education. Call of Duty: World at War: Call of Duty: World at War is a 2008 first - person shooter video game developed by Treyarch and published by Activision for Microsoft Windows, PlayStation 3, Wii, and Xbox 360. The game is the fifth mainstream game of the Call of Duty series and returns the setting to World War II for the last time until Call of Duty: WWII almost nine years later. The game is also the first title in the Black Ops story line. The game was released in North America on November 11, 2008, and in Europe on November 14, 2008. A Windows Mobile version was also made available by Glu Mobile and different storyline versions for the Nintendo DS and PlayStation 2 were also produced, but remain in the World War II setting. The game is based on an enhanced version of the Call of Duty 4: Modern Warfare game engine developed by Infinity Ward with increased development on audio and visual effects. Klebsiella granulomatis: Klebsiella granulomatis is Gram-negative, rod-shaped bacterium of the genus \"Klebsiella\" known to cause the sexually transmitted disease granuloma inguinale (or donovanosis). It was called \"Calymmatobacterium granulomatis\". Alzheimer's disease: Alzheimer's disease has been identified as a protein misfolding disease (proteopathy), caused by plaque accumulation of abnormally folded amyloid beta protein and tau protein in the brain. Plaques are made up of small peptides, 39–43 amino acids in length, called amyloid beta (Aβ). Aβ is a fragment from the larger amyloid precursor protein (APP). APP is a transmembrane protein that penetrates through the neuron's membrane. APP is critical to neuron growth, survival, and post-injury repair. In Alzheimer's disease, gamma secretase and beta secretase act together in a proteolytic process which causes APP to be divided into smaller fragments. One of these fragments gives rise to fibrils of amyloid beta, which then form clumps that deposit outside neurons in dense formations known as senile plaques.AD is also considered a tauopathy due to abnormal aggregation of the tau protein. Every neuron has a cytoskeleton, an internal support structure partly made up of structures called microtubules. These microtubules act like tracks, guiding nutrients and molecules from the body of the cell to the ends of the axon and back. A protein called tau stabilises the microtubules when phosphorylated, and is therefore called a microtubule-associated protein. In AD, tau undergoes chemical changes, becoming hyperphosphorylated; it then begins to pair with other threads, creating neurofibrillary tangles and disintegrating the neuron's transport system. Pathogenic tau can also cause neuronal death through transposable element dysregulation."

tok = BartTokenizer.from_pretrained("facebook/bart-large")
bart_tok_len = lambda x: len(tok(x)["input_ids"])

text_splitter = RecursiveCharacterTextSplitter(
    chunk_size=30,
    chunk_overlap=0,
    length_function=bart_tok_len,
    is_separator_regex=False,

)

text_splitter2 = CharacterTextSplitter.from_tiktoken_encoder(
    chunk_size=5, chunk_overlap=0
)

texts = text_splitter2.split_text(text)
print(texts)

tokenizer = AutoTokenizer.from_pretrained("microsoft/deberta-v3-large")


def length_function(text):
    return len(tokenizer.encode(text, add_special_tokens=False))

text_splitter3 = RecursiveCharacterTextSplitter(
    length_function=length_function,
    chunk_size=100,
    chunk_overlap=15,
)

chunks = text_splitter3.split_text("999 (emergency telephone number): The pan-European 112 code was introduced in the UK in April 1995 with little publicity. It connects to existing 999 circuits. The GSM standard mandates that the user of a GSM phone can dial 112 without unlocking the keypad, a feature that can save time in emergencies but that also causes some accidental calls. All mobile telephones will make emergency calls with the keypad locked. Originally a valid SIM card was not required to make a 999 / 112 emergency call in the UK. However, as a result of high numbers of untraceable hoax calls being made, this feature is now blocked by all UK networks. Most UK mobile telephone handsets will dial 999 / 112 without a SIM inserted (or with a locked / invalid SIM), but the call will not be connected. Following the blocking of SIM-less calls, in 2009 the UK networks introduced emergency call roaming. This allows a user with a valid SIM of a UK network to make emergency calls on any network for which they have coverage. Energy: This principle is vitally important to understanding the behaviour of a quantity closely related to energy, called entropy. Entropy is a measure of evenness of a distribution of energy between parts of a system. When an isolated system is given more degrees of freedom (i.e., given new available energy states that are the same as existing states), then total energy spreads over all available degrees equally without distinction between \"new\" and \"old\" degrees. This mathematical result is called the second law of thermodynamics. Wernicke's area: Wernicke's area is named after Carl Wernicke, a German neurologist and psychiatrist who, in 1874, hypothesized a link between the left posterior section of the superior temporal gyrus and the reflexive mimicking of words and their syllables that associated the sensory and motor images of spoken words. He did this on the basis of the location of brain injuries that caused aphasia. Receptive aphasia in which such abilities are preserved is also known as Wernicke's aphasia. In this condition there is a major impairment of language comprehension, while speech retains a natural-sounding rhythm and a relatively normal syntax. Language as a result is largely meaningless (a condition sometimes called \"fluent\" or \"jargon aphasia\"). State legislature (United States): Nebraska originally had a bicameral legislature like the other states, but the lower house was abolished following a referendum, effective with the 1936 elections. The remaining unicameral (one - chamber) legislature is called the Nebraska Legislature, but its members continue to be called senators. End Conscription Campaign: On 24 August 1993 Minister of Defence Kobie Coetsee announced the end of conscription. In 1994 there would be no more call - ups for the one - year initial training. But although conscription was suspended it was not entirely abandoned. Indeed, in January 1994 for the first time there was no call - up for initial training, but at the same time conscripts who had already undergone training could be subject to ``camp ''call - ups, as they were technically subject to military law rather than civilian law. Actually`` camp'' call - ups reached record proportions over the period of the April 1994 elections, and for the first time in history the ECC called on conscripts to consider these call - ups to be different from previous call - ups. Buddhism: In Buddhism, Karma (from Sanskrit: \"action, work\") is the force that drives saṃsāra—the cycle of suffering and rebirth for each being. Good, skillful deeds (Pali: \"kusala\") and bad, unskillful (Pāli: \"akusala\") actions produce \"seeds\" in the mind that come to fruition either in this life or in a subsequent rebirth. The avoidance of unwholesome actions and the cultivation of positive actions is called sīla. Karma specifically refers to those actions of body, speech or mind that spring from mental intent (cetanā), and bring about a consequence or phala \"fruit\" or vipāka \"result\". Canon law: Much of the legislative style was adapted from the Roman Law Code of Justinian. As a result, Roman ecclesiastical courts tend to follow the Roman Law style of continental Europe with some variation, featuring collegiate panels of judges and an investigative form of proceeding, called \"inquisitorial\", from the Latin \"inquirere\", to enquire. This is in contrast to the adversarial form of proceeding found in the common law system of English and U.S. law, which features such things as juries and single judges. False Claims Act: The False Claims Act, also called the ``Lincoln Law '') is an American federal law that imposes liability on persons and companies (typically federal contractors) who defraud governmental programs. It is the federal Government's primary litigation tool in combating fraud against the Government. The law includes a qui tam provision that allows people who are not affiliated with the government, called`` relators'' under the law, to file actions on behalf of the government (informally called ``whistleblowing ''especially when the relator is employed by the organization accused in the suit). Persons filing under the Act stand to receive a portion (usually about 15 -- 25 percent) of any recovered damages. As of 2012, over 70 percent of all federal Government FCA actions were initiated by whistleblowers. Claims under the law have typically involved health care, military, or other government spending programs, and dominate the list of largest pharmaceutical settlements. The government recovered $38.9 billion under the False Claims Act between 1987 and 2013 and of this amount, $27.2 billion or 70% was from qui tam cases brought by relators. Geological history of Earth: The Ordovician Period started at a major extinction event called the Cambrian-Ordovician extinction events some time about 485.4 ± 1.9 Ma. During the Ordovician the southern continents were collected into a single continent called Gondwana. Gondwana started the period in the equatorial latitudes and, as the period progressed, drifted toward the South Pole. Early in the Ordovician the continents Laurentia, Siberia and Baltica were still independent continents (since the break-up of the supercontinent Pannotia earlier), but Baltica began to move toward Laurentia later in the period, causing the Iapetus Ocean to shrink between them. Also, Avalonia broke free from Gondwana and began to head north toward Laurentia. The Rheic Ocean was formed as a result of this. By the end of the period, Gondwana had neared or approached the pole and was largely glaciated. La Tour-Blanche Anticline: The La Tour-Blanche Anticline, also called Chapdeuil Anticline or Chapdeuil-La Tour-Blanche Anticline, is a tectonically caused, dome-like upwarp in the sedimentary succession of the northeastern Aquitaine Basin in France. The structure is oriented west-northwest-east-southeast. Vacuum: QED vacuum has interesting and complex properties. In QED vacuum, the electric and magnetic fields have zero average values, but their variances are not zero. As a result, QED vacuum contains vacuum fluctuations (virtual particles that hop into and out of existence), and a finite energy called vacuum energy. Vacuum fluctuations are an essential and ubiquitous part of quantum field theory. Some experimentally verified effects of vacuum fluctuations include spontaneous emission and the Lamb shift. Coulomb's law and the electric potential in vacuum near an electric charge are modified. National Do Not Call Registry: On June 27, 2003, the U.S. Federal Trade Commission (FTC) opened the National Do Not Call Registry in order to comply with the Do - Not - Call Implementation Act of 2003 (Pub. L. 108 -- 10, was H.R. 395, and codified at 15 U.S.C. § 6101 et. seq.), sponsored by Representatives Billy Tauzin and John Dingell and signed into law by President George W. Bush on March 11, 2003. The law established the FTC's National Do Not Call Registry in order to facilitate compliance with the Telephone Consumer Protection Act of 1991. Chromosome 21: In a small percentage of cases, Down syndrome is caused by a rearrangement of chromosomal material between chromosome 21 and another chromosome. As a result, a person has the usual two copies of chromosome 21, plus extra material from chromosome 21 attached to another chromosome. These cases are called translocation Down syndrome. Researchers believe that extra copies of genes on chromosome 21 disrupt the course of normal development, causing the characteristic features of Down syndrome and the increased risk of medical problems associated with this disorder. James Gillett: The denying of Pardee's renomination caused immediate controversy and outrage. Pardee, due to his efficient bureaucracy and direction of the state government's response to the 1906 San Francisco earthquake, remained an enormously popular politician. His replacement by Gillett, a Railroad Republican, caused anger both in the press and within political circles. The San Francisco Call printed a photograph taken at the convention's end of Gillett among top party bosses entitled ``the Shame of California. ''Gillett's nomination by special interests would fuel calls for a direct primary law in the state. Immune system: Another important role of the immune system is to identify and eliminate tumors. This is called immune surveillance. The transformed cells of tumors express antigens that are not found on normal cells. To the immune system, these antigens appear foreign, and their presence causes immune cells to attack the transformed tumor cells. The antigens expressed by tumors have several sources; some are derived from oncogenic viruses like human papillomavirus, which causes cervical cancer, while others are the organism's own proteins that occur at low levels in normal cells but reach high levels in tumor cells. One example is an enzyme called tyrosinase that, when expressed at high levels, transforms certain skin cells (e.g. melanocytes) into tumors called melanomas. A third possible source of tumor antigens are proteins normally important for regulating cell growth and survival, that commonly mutate into cancer inducing molecules called oncogenes. Julien Chouinard: Born in Quebec City, the son of Joseph Julien Chouinard and Berthe Cloutier, he received a BA in 1948 and a LL.L. in 1951 from Université Laval. As a Rhodes Scholar, he received a BA in 1953 from Oxford University. In 1953, he was called to the Quebec Bar and started to practice law. He also taught law at Université Laval. Zack Kopplin: Zachary \"Zack\" Sawyer Kopplin (born July 20, 1993) is an American political activist, journalist, and television personality from Louisiana. Kopplin has campaigned to keep creationism out of public school science classrooms and been involved with other separation of church and state causes. He has opposed school vouchers because they provide public money to schools which may teach creationism. As a high school student, he organized seventy-eight Nobel laureate scientists in a campaign against the Louisiana Science Education Act, a creationism law. He is also involved with science funding policy and curriculum and textbook policy. His new campaign calls for a launching Second Giant Leap for Humankind, calling for Barack Obama to invest $1 trillion in research and education. Call of Duty: World at War: Call of Duty: World at War is a 2008 first - person shooter video game developed by Treyarch and published by Activision for Microsoft Windows, PlayStation 3, Wii, and Xbox 360. The game is the fifth mainstream game of the Call of Duty series and returns the setting to World War II for the last time until Call of Duty: WWII almost nine years later. The game is also the first title in the Black Ops story line. The game was released in North America on November 11, 2008, and in Europe on November 14, 2008. A Windows Mobile version was also made available by Glu Mobile and different storyline versions for the Nintendo DS and PlayStation 2 were also produced, but remain in the World War II setting. The game is based on an enhanced version of the Call of Duty 4: Modern Warfare game engine developed by Infinity Ward with increased development on audio and visual effects. Klebsiella granulomatis: Klebsiella granulomatis is Gram-negative, rod-shaped bacterium of the genus \"Klebsiella\" known to cause the sexually transmitted disease granuloma inguinale (or donovanosis). It was called \"Calymmatobacterium granulomatis\". Alzheimer's disease: Alzheimer's disease has been identified as a protein misfolding disease (proteopathy), caused by plaque accumulation of abnormally folded amyloid beta protein and tau protein in the brain. Plaques are made up of small peptides, 39–43 amino acids in length, called amyloid beta (Aβ). Aβ is a fragment from the larger amyloid precursor protein (APP). APP is a transmembrane protein that penetrates through the neuron's membrane. APP is critical to neuron growth, survival, and post-injury repair. In Alzheimer's disease, gamma secretase and beta secretase act together in a proteolytic process which causes APP to be divided into smaller fragments. One of these fragments gives rise to fibrils of amyloid beta, which then form clumps that deposit outside neurons in dense formations known as senile plaques.AD is also considered a tauopathy due to abnormal aggregation of the tau protein. Every neuron has a cytoskeleton, an internal support structure partly made up of structures called microtubules. These microtubules act like tracks, guiding nutrients and molecules from the body of the cell to the ends of the axon and back. A protein called tau stabilises the microtubules when phosphorylated, and is therefore called a microtubule-associated protein. In AD, tau undergoes chemical changes, becoming hyperphosphorylated; it then begins to pair with other threads, creating neurofibrillary tangles and disintegrating the neuron's transport system. Pathogenic tau can also cause neuronal death through transposable element dysregulation.")



print(length_function(GLINER_LLM_PROMPT.format_prompt(text=chunks[0]).to_string()))



